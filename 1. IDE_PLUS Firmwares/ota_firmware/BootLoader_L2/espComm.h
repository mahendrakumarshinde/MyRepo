#ifndef ESPCOMM_H
#define ESPCOMM_H
#include <inttypes.h>
#include "FS.h"
#include "bootloaderCodes.h"

#define FLASH_BLOCK_SIZE  4096  //16384
#define MAX_FILE_RW_SIZE  512
#define ESP32_ENABLE_PIN  A2
#define ESP32_IO0         7
#define DEBUG_SERIAL Serial4 

class espComm
{
    /* data */
    public:
        uint16_t flash_esp32_verify(char* folderPath,char* fileName);
        void espCleanup();
        bool esp_SendSyncCmd(uint8_t rebootCount, uint8_t retrySync);
        bool espSendCmd(byte command[], int size, int retry,uint8_t countC0 = 2);
        bool espDetect();
    // bool espEraseFlash();
        bool espGetFeature();
        bool espGetMacId();
        bool espUploadStub();
        bool espConfigureFlash();
        bool espExitFlash();
        String espGetMD5Hash();
        void espReboot();
        bool compareResponse(byte *a, byte *b, int len_a, int len_b);
        bool espBinWrite(char *folderName,char *fileName);
        bool espSendDataPkt(unsigned char *command, uint32_t size, int retry, uint16_t seq);
        uint32_t espcomm_calc_checksum(unsigned char *data, uint16_t data_size);
        bool preparePkt(unsigned char* buff,uint16_t sequenceNumber, uint32_t pktsize);
        unsigned int update_C0_DB(unsigned char *destPkt,unsigned char *srcBuf, unsigned int size);
    //   bool send_command_with_response_c0_1(unsigned char *command, uint32_t size, int retry,uint16_t seq);
        File espFlashLog;
        private:
        byte syncCommand[46] = {0xc0,0x00,0x08,0x24,0x00,0x00,0x00,0x00,0x00,0x07,0x07,0x12,0x20,
                                0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
                                0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,0x55,
                                0x55,0x55,0x55,0x55,0x55,0x55,0xc0};

        byte deviceType[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0xa0, 0x01, 0x60, 0xc0};
        byte chipId[14]   = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0c, 0xa0, 0x01, 0x60, 0xc0};

        byte readReg1[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0xa0, 0x01, 0x60, 0xc0}; 

        byte readReg2[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, 0xa0, 0x01, 0x60, 0xc0};

        byte MacIDreg1[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0xa0, 0x01, 0x60, 0xc0};
        byte MacIDreg2[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0xa0, 0x01, 0x60, 0xc0};

        byte uploadStub[26] = {0xc0,0x00,0x05,0x10,0x00,0x00,0x00,0x00,0x00,0x44,0x0c,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x18,0x00,0x00,0x00,0xf0,0x09,0x40,0xc0};

        byte uploadStub0[3247] = { 0xc0,0x00,0x07,0x54,0x0c,0x06,0x00,0x00,0x00,0x44,0x0c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xf8,0x20,0xf4,0x3f,0xf8,0x30,0xf4,0x3f,0x36,0x41,0x00,0x91,0xfd,0xff,0xdb,0xdc,0x20,0x00,0x88,0x09,0x80,0x80,0x24,0x56,0x48,0xff,0x91,0xfa,0xff,0xdb,0xdc,0x20,0x00,0x88,0x09,0x80,0x80,0x24,0x56,0x48,0xff,0x1d,0xf0,0x00,0x00,0x00,0x10,0x20,0xf4,0x3f,0x00,0x20,0xf4,0x3f,0x00,0x00,0x00,0x08,0x36,0x41,0x00,0xe5,0xfc,0xff,0x81,0xfb,0xff,0x0c,0x02,0xdb,0xdc,0x20,0x00,0x29,0x08,0x91,0xfa,0xff,0x21,0xfa,0xff,0xdb,0xdc,0x20,0x00,0x22,0x69,
                            0x00,0xdb,0xdc,0x20,0x00,0x28,0x09,0x56,0x72,0xff,0xdb,0xdc,0x20,0x00,0x88,0x08,0x0c,0x12,0x80,0x80,0x04,0x20,0x28,0x30,0x1d,0xf0,0x00,0x00,0x00,0x00,0x40,0x36,0x41,0x00,0x65,0xfc,0xff,0x16,0x9a,0xff,0x81,0xed,0xff,0x91,0xfc,0xff,0xdb,0xdc,0x20,0x00,0x99,0x08,0xdb,0xdc,0x20,0x00,0x98,0x08,0x56,0x79,0xff,0x1d,0xf0,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x80,0x00,0x98,0xdb,0xdc,0xff,0x3f,0xff,0xff,0xff,0x00,0x04,0x20,0xf4,0x3f,0x36,0x41,0x00,0x21,0xfc,0xff,0x32,0x22,0x04,0x16,0x43,0x05,0x65,0xf8,0xff,0x16,0xea,0x04,0xa5,0xfb,0xff,0x58,0x42,0x0c,0xf8,0x0c,
                            0x13,0x41,0xf4,0xff,0x57,0xa8,0x0b,0x58,0x22,0x80,0x55,0x10,0xcc,0x35,0x41,0xf2,0xff,0x1c,0x03,0x88,0x22,0x40,0x58,0x11,0x25,0xf3,0xff,0x81,0xf0,0xff,0x80,0x85,0x10,0x51,0xf0,0xff,0xdb,0xdc,0x20,0x00,0x89,0x05,0x81,0xd2,0xff,0xdb,0xdc,0x20,0x00,0x42,0x68,0x00,0xdb,0xdc,0x20,0x00,0x48,0x08,0x56,0x74,0xff,0x88,0x42,0x48,0x22,0x30,0x88,0xdb,0xdc,0x3a,0x34,0x89,0x42,0x39,0x22,0x1d,0xf0,0x00,0x08,0x00,0xf4,0x3f,0x1c,0x00,0xf4,0x3f,0x00,0x00,0xf4,0x3f,0x90,0xdb,0xdc,0xff,0x3f,0x08,0x40,0xff,0x3f,0x80,0x80,0x00,0x00,0x84,0x80,0x00,0x00,0x40,0x40,0x00,0x00,0x48,
                            0x80,0xff,0x3f,0x10,0x00,0xf4,0x3f,0x94,0xdb,0xdc,0xff,0x3f,0x36,0x41,0x00,0x21,0xf4,0xff,0x31,0xf7,0xff,0x41,0xf7,0xff,0xdb,0xdc,0x20,0x00,0x58,0x02,0x4a,0x43,0x61,0xf1,0xff,0xdb,0xdc,0x20,0x00,0x28,0x06,0x20,0x20,0x74,0x16,0xe2,0x09,0xc6,0x23,0x00,0x61,0xee,0xff,0xb1,0xee,0xff,0xdb,0xdc,0x20,0x00,0xa2,0x26,0x00,0xa0,0xa0,0x74,0x25,0xa8,0x00,0x96,0xca,0x04,0x91,0xea,0xff,0x81,0xeb,0xff,0xb1,0xeb,0xff,0x80,0x89,0x80,0xb0,0xb9,0x80,0xdb,0xdc,0x20,0x00,0xc8,0x08,0x92,0x1b,0x00,0xa0,0xa0,0x74,0x90,0x80,0xf4,0x1b,0x98,0x90,0x90,0xf4,0xdb,0xdc,0x20,0x00,0x92,
                            0x5b,0x00,0x8a,0x8c,0xdb,0xdc,0x20,0x00,0xa2,0x48,0x00,0x82,0x1b,0x00,0x91,0xe1,0xff,0x80,0x80,0xf4,0x97,0x98,0x3e,0xdb,0xdc,0x20,0x00,0xa8,0x04,0x81,0xe0,0xff,0x91,0xdd,0xff,0x37,0x9a,0x19,0x46,0x02,0x00,0x7c,0xe8,0x87,0x1a,0xe9,0x46,0x09,0x00,0x00,0x00,0xdb,0xdc,0x20,0x00,0x39,0x08,0xdb,0xdc,0x20,0x00,0x99,0x04,0x46,0x02,0x00,0xdb,0xdc,0x20,0x00,0x99,0x08,0xdb,0xdc,0x20,0x00,0x39,0x04,0x81,0xd1,0xff,0x0c,0x09,0x8a,0x83,0xdb,0xdc,0x20,0x00,0x92,0x58,0x00,0x0b,0x22,0x26,0x02,0x02,0xc6,0xd9,0xff,0xc6,0xd4,0xff,0x00,0x21,0xce,0xff,0xdb,0xdc,0x20,0x00,0x59,
                            0x02,0x1d,0xf0,0x00,0x00,0x50,0x2d,0x06,0x40,0x36,0x41,0x00,0x41,0xa4,0xff,0x58,0x34,0x30,0x35,0x63,0x16,0xe3,0x03,0x58,0x14,0x5a,0x53,0x50,0x5c,0x41,0x86,0x00,0x00,0x65,0xe8,0xff,0x88,0x44,0xa6,0x18,0x04,0x88,0x24,0x87,0xa5,0xf2,0xe5,0xe0,0xff,0x16,0x9a,0xff,0xa8,0x14,0x30,0xc3,0x20,0x20,0xb2,0x20,0x81,0xf2,0xff,0xe0,0x08,0x00,0x8c,0x3a,0x22,0xa0,0xc4,0x29,0x54,0x58,0x14,0x3a,0x55,0x59,0x14,0x58,0x34,0x30,0x35,0xdb,0xdc,0x39,0x34,0x1d,0xf0,0x00,0x08,0x20,0xf4,0x3f,0x00,0x00,0x40,0x00,0x70,0xe2,0xfa,0x3f,0x48,0x24,0x06,0x40,0xf0,0x22,0x06,0x40,0x36,0x61,
                            0x00,0xe5,0xd9,0xff,0xad,0x01,0x81,0xfc,0xff,0xe0,0x08,0x00,0x3d,0x0a,0x0c,0x12,0xec,0xea,0x98,0x01,0x82,0xa2,0x00,0x80,0x89,0x10,0x89,0x01,0xa5,0xde,0xff,0x91,0xf2,0xff,0x81,0xf3,0xff,0xdb,0xdc,0x20,0x00,0xa8,0x09,0x80,0x8a,0x20,0xdb,0xdc,0x20,0x00,0x82,0x69,0x00,0xb2,0x21,0x00,0xa1,0xef,0xff,0x81,0xf0,0xff,0xe0,0x08,0x00,0xa0,0x23,0x83,0x1d,0xf0,0x00,0x00,0xff,0x0f,0x00,0x00,0x36,0x41,0x00,0xa1,0x78,0xff,0x91,0xfd,0xff,0x82,0xa0,0x01,0x82,0x4a,0x00,0x32,0x6a,0x01,0x30,0x8c,0x41,0x22,0x6a,0x03,0x30,0x30,0xb4,0x9a,0x22,0x89,0x2a,0x2a,0x83,0x80,0x8c,0x41,
                            0x0c,0x02,0x89,0x4a,0x29,0x5a,0xa5,0xf8,0xff,0x2d,0x0a,0x32,0xa0,0xc5,0xa0,0x23,0x93,0x1d,0xf0,0x00,0x2c,0x92,0x00,0x40,0x36,0x41,0x00,0x82,0xa0,0xdb,0xdc,0xad,0x02,0x87,0x92,0x0e,0xa2,0xa0,0xdb,0xdd,0x81,0xfb,0xff,0xe0,0x08,0x00,0xa2,0xa0,0xdc,0x86,0x03,0x00,0x82,0xa0,0xdb,0xdd,0x87,0x92,0x08,0x81,0xf7,0xff,0xe0,0x08,0x00,0xa2,0xa0,0xdd,0x81,0xf4,0xff,0xe0,0x08,0x00,0x1d,0xf0,0x00,0x00,0x00,0x36,0x41,0x00,0x3a,0x32,0x06,0x02,0x00,0x00,0xa2,0x02,0x00,0x1b,0x22,0xe5,0xfb,0xff,0x37,0x92,0xf4,0x1d,0xf0,0x00,0x00,0x00,0x10,0x00,0x00,0x58,0x10,0x00,0x00,0x7c,
                            0xda,0x05,0x40,0xd8,0x2e,0x06,0x40,0x9c,0xda,0x05,0x40,0x1c,0xdb,0xdd,0x05,0x40,0x36,0x21,0x21,0xa2,0xd1,0x10,0x81,0xfa,0xff,0xe0,0x08,0x00,0x86,0x09,0x00,0x00,0x51,0xf6,0xff,0xbd,0x01,0x50,0x43,0x63,0xcd,0x04,0xad,0x02,0x81,0xf6,0xff,0xe0,0x08,0x00,0xec,0xfa,0xcd,0x04,0xbd,0x01,0xa2,0xd1,0x10,0x81,0xf3,0xff,0xe0,0x08,0x00,0x4a,0x22,0x40,0x33,0xdb,0xdc,0x56,0x63,0xfd,0xa1,0xec,0xff,0xb2,0xd1,0x10,0x1a,0xaa,0x81,0xee,0xff,0xe0,0x08,0x00,0xa1,0xe9,0xff,0x1c,0x0b,0x1a,0xaa,0x25,0xf8,0xff,0x2d,0x03,0x1d,0xf0,0x22,0xa0,0x63,0x1d,0xf0,0x00,0x00,0x36,0x41,0x00,
                            0xa2,0xa0,0xdb,0xdc,0x81,0xcd,0xff,0xe0,0x08,0x00,0x1d,0xf0,0x00,0x00,0x68,0x10,0x00,0x00,0x70,0x10,0x00,0x00,0x74,0x10,0x00,0x00,0x78,0x10,0x00,0x00,0xfc,0x67,0x00,0x40,0xa4,0x92,0x00,0x40,0x08,0x68,0x00,0x40,0x36,0x41,0x21,0x61,0xf9,0xff,0x81,0xf9,0xff,0x1a,0x66,0x1a,0x88,0x49,0x06,0x72,0xd1,0x10,0x0c,0x06,0x2c,0x0a,0x59,0x08,0x62,0x67,0x1a,0x81,0xf6,0xff,0xe0,0x08,0x00,0x81,0xcf,0xff,0x47,0xb8,0x02,0x46,0x36,0x00,0xad,0x07,0x81,0xcf,0xff,0xe0,0x08,0x00,0x4d,0x06,0x51,0xef,0xff,0x61,0xcb,0xff,0x1a,0x55,0x6a,0x81,0x89,0x05,0x06,0x2d,0x00,0x00,0x81,0xe9,
                            0xff,0x40,0x63,0xdb,0xdc,0x1a,0x88,0x88,0x08,0xbd,0x01,0x60,0x68,0x63,0xcd,0x06,0x20,0xa2,0x20,0x81,0xc5,0xff,0xe0,0x08,0x00,0x8c,0xea,0x91,0xe1,0xff,0x0c,0x05,0x52,0x67,0x16,0x6d,0x05,0x9a,0x51,0x46,0x0d,0x00,0x00,0x25,0xf6,0xff,0x60,0xb6,0x20,0xad,0x01,0xe5,0xec,0xff,0xa5,0xf5,0xff,0xcd,0x06,0x10,0xb1,0x20,0x70,0xa7,0x20,0x81,0xba,0xff,0xe0,0x08,0x00,0x6a,0x22,0x6a,0x44,0x37,0xb4,0xcc,0x81,0xd6,0xff,0x50,0x64,0xdb,0xdc,0x1a,0x88,0x88,0x08,0x87,0x36,0xa3,0x06,0xef,0xff,0x00,0x00,0x81,0xd4,0xff,0xe0,0x08,0x00,0x81,0xd1,0xff,0x10,0x88,0x80,0xb2,0x28,0x00,
                            0x65,0x75,0x00,0xf7,0xea,0x0d,0xf6,0x46,0x0a,0x60,0xb5,0x80,0xa2,0x4b,0x00,0x1b,0x66,0x06,0xf7,0xff,0x7c,0xeb,0xb7,0x9a,0xd7,0x26,0x46,0x27,0xa1,0xa5,0xff,0x70,0xb7,0x20,0x1a,0xaa,0x81,0xa7,0xff,0xe0,0x08,0x00,0x65,0xef,0xff,0xa1,0xa0,0xff,0x1c,0x0b,0x1a,0xaa,0xe5,0xe5,0xff,0xa5,0xee,0xff,0x2c,0x0a,0x81,0xc3,0xff,0xe0,0x08,0x00,0x1d,0xf0,0x52,0x27,0x1a,0x37,0xb5,0xd1,0x57,0xb4,0x8e,0xc6,0xf2,0xff,0x1d,0xf0,0x00,0x00,0x00,0xdb,0xdc,0xfe,0x3f,0x4f,0x48,0x41,0x49,0xa4,0xeb,0xff,0x3f,0x34,0xf1,0x09,0x40,0x0c,0x00,0xf4,0x3f,0x38,0x40,0xf4,0x3f,0xff,0xff,0x00,
                            0x00,0x00,0x00,0x01,0x00,0x8c,0x80,0x00,0x00,0x10,0x40,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0xdb,0xdc,0xfe,0x3f,0x04,0xdb,0xdc,0xfe,0x3f,0x10,0x27,0x00,0x00,0x14,0x00,0xf4,0x3f,0xff,0xff,0x0f,0x00,0xa4,0xeb,0xff,0x3f,0x08,0xdb,0xdc,0xfe,0x3f,0xb0,0xdb,0xdc,0xff,0x3f,0x7c,0x68,0x00,0x40,0xec,0x67,0x00,0x40,0x58,0x86,0x00,0x40,0x6c,0x2a,0x06,0x40,0x38,0x32,0x06,0x40,0xcc,0x2c,0x06,0x40,0x4c,0x2c,0x06,0x40,0x34,0x85,0x00,0x40,0xcc,0x90,0x00,0x40,0x30,0xef,0x05,0x40,0x58,0x92,0x00,0x40,0x4c,0x82,0x00,0x40,0x14,0x2c,0x06,0x40,0x36,0xc1,0x00,0x21,0xe0,0xff,0x0c,
                            0x0a,0x22,0x61,0x08,0x42,0xa0,0x00,0x81,0xef,0xff,0xe0,0x08,0x00,0x21,0xdb,0xdd,0xff,0x31,0xdc,0xff,0x06,0x01,0x00,0x42,0x62,0x00,0x4b,0x22,0x37,0x32,0xf7,0x65,0xe2,0xff,0x0c,0x4b,0xa2,0xc1,0x20,0x25,0xd9,0xff,0xa5,0xe1,0xff,0x41,0xe0,0xfe,0x21,0xe0,0xfe,0xb1,0xd4,0xff,0x0c,0x0c,0x2a,0x24,0x0c,0x5a,0xdb,0xdc,0x20,0x00,0x49,0x02,0x81,0xe2,0xff,0xe0,0x08,0x00,0x31,0xd0,0xff,0x22,0xa1,0x01,0xdb,0xdc,0x20,0x00,0x58,0x03,0x2c,0x0a,0x20,0x25,0x20,0xdb,0xdc,0x20,0x00,0x29,0x03,0x81,0x84,0xff,0xe0,0x08,0x00,0x81,0xdb,0xdd,0xff,0xe0,0x08,0x00,0x21,0xc9,0xff,0xdb,
                            0xdc,0x20,0x00,0x38,0x02,0xcc,0xba,0x1c,0xc2,0x20,0x23,0x10,0x22,0xc2,0xf8,0x0c,0x13,0x20,0xa3,0x83,0x0c,0x0b,0x81,0xd4,0xff,0xe0,0x08,0x00,0xf1,0xc2,0xff,0xd1,0x52,0xff,0xc1,0xc2,0xff,0xb1,0xa5,0xfe,0xe2,0xa1,0x00,0x0c,0x0a,0x81,0xcf,0xff,0xe0,0x08,0x00,0x31,0xa4,0xfe,0x52,0xd3,0x2b,0x41,0xc2,0xfe,0x61,0xbc,0xff,0x6a,0x24,0xdb,0xdc,0x20,0x00,0x68,0x02,0x16,0x76,0xff,0xdb,0xdc,0x20,0x00,0x78,0x02,0x0c,0x06,0xdb,0xdc,0x20,0x00,0x69,0x02,0x0c,0x12,0x22,0x41,0x10,0x22,0x07,0x01,0x0c,0x28,0x22,0x41,0x11,0x82,0x51,0x09,0x69,0x51,0x26,0x92,0x08,0x1c,0x36,0x67,
                            0x12,0x1f,0x46,0x08,0x00,0x00,0x22,0x07,0x03,0x62,0x07,0x02,0x80,0x22,0x11,0x60,0x22,0x20,0x66,0x42,0x11,0x28,0x27,0xdb,0xdc,0x20,0x00,0x28,0x02,0x29,0x51,0x46,0x01,0x00,0x00,0x1c,0x22,0x22,0x51,0x09,0x65,0xd4,0xff,0x0c,0x8b,0xa2,0xc1,0x10,0x25,0xcb,0xff,0x22,0x07,0x03,0x82,0x07,0x02,0x80,0x22,0x11,0x80,0x82,0x20,0x21,0xa2,0xff,0x87,0xb2,0x11,0xa2,0xa0,0xdb,0xdc,0x65,0xc6,0xff,0xa2,0xa0,0xee,0x25,0xc6,0xff,0xe5,0xd1,0xff,0x46,0xdd,0xff,0x62,0x07,0x01,0x0c,0xd2,0x27,0x96,0x02,0x06,0x91,0x00,0x67,0x32,0x4e,0x66,0x66,0x02,0xc6,0xaf,0x00,0xf6,0x76,0x20,0x66,
                            0x36,0x02,0xc6,0x65,0x00,0xf6,0x46,0x08,0x66,0x26,0x02,0xc6,0x4b,0x00,0x46,0xae,0x00,0x66,0x46,0x02,0x06,0x7b,0x00,0x66,0x56,0x02,0x86,0x8e,0x00,0x86,0xaa,0x00,0x0c,0x92,0x27,0x96,0x02,0x06,0x86,0x00,0x67,0x32,0x08,0x66,0x76,0x02,0xc6,0x8b,0x00,0x86,0xa5,0x00,0x66,0x96,0x02,0xc6,0x83,0x00,0x0c,0xb2,0x27,0x96,0x02,0x46,0x79,0x00,0x46,0xa1,0x00,0x1c,0x32,0x27,0x96,0x02,0xc6,0x39,0x00,0x67,0x32,0x28,0x66,0xb6,0x02,0xc6,0x43,0x00,0x1c,0x02,0x67,0x32,0x0a,0x0c,0xf2,0x27,0x96,0x02,0x06,0x2e,0x00,0x06,0x99,0x00,0x1c,0x12,0x27,0x96,0x02,0x86,0x4b,0x00,0x1c,0x22,
                            0x27,0x96,0x02,0x46,0x63,0x00,0x46,0x94,0x00,0x22,0xa0,0xd1,0x27,0x16,0x2d,0x67,0x32,0x09,0x22,0xa0,0xd0,0x27,0x16,0x18,0xc6,0x8f,0x00,0x00,0x22,0xa0,0xd2,0x27,0x96,0x02,0x86,0x25,0x00,0x22,0xa0,0xd3,0x27,0x96,0x02,0x46,0x25,0x01,0x46,0x8a,0x00,0x0c,0x12,0x16,0x18,0x3e,0xad,0x02,0x2d,0x0a,0x86,0x85,0x00,0x26,0x88,0x02,0x86,0x83,0x00,0xc6,0xf8,0x00,0x00,0x00,0xe5,0xaf,0xff,0x60,0x46,0x20,0x60,0x22,0x80,0x16,0x2a,0x01,0x86,0x7e,0x00,0x00,0xa0,0xac,0x41,0x81,0x72,0xff,0xe0,0x08,0x00,0x56,0xda,0x1e,0x42,0xd4,0xf0,0x40,0xa2,0xdb,0xdc,0xcc,0x24,0x86,0x01,0x01,
                            0x00,0xa0,0x60,0xf4,0x56,0x16,0xfe,0x61,0x5a,0xff,0x86,0x03,0x00,0xa0,0xa0,0xf5,0x81,0x6a,0xff,0xe0,0x08,0x00,0x56,0x9a,0x1c,0x60,0x44,0xdb,0xdc,0x40,0xa2,0xdb,0xdc,0x47,0x36,0xea,0x86,0x03,0x00,0xa0,0xac,0x41,0x81,0x63,0xff,0xe0,0x08,0x00,0x56,0x1a,0x1b,0x42,0xd4,0xf0,0x40,0xa2,0xdb,0xdc,0x56,0xa4,0xfe,0x46,0xf2,0x00,0x0c,0x06,0x22,0xa0,0xdb,0xdc,0x26,0x88,0x02,0x46,0x6a,0x00,0x86,0xf2,0x00,0x00,0x00,0x66,0xb8,0x02,0x86,0xf0,0x00,0x86,0x46,0x00,0x66,0xb8,0x02,0x86,0xdb,0xdd,0x00,0xc6,0x60,0x00,0x22,0xa0,0x01,0x26,0xb8,0x02,0x06,0x5f,0x00,0x92,0x27,0x04,
                            0x81,0x44,0xff,0x62,0xa0,0x00,0x22,0xa0,0xc2,0x87,0x19,0x02,0xc6,0x5d,0x00,0xb8,0x57,0xa8,0x27,0x65,0xaa,0xff,0xc6,0xd3,0x00,0x00,0x00,0x00,0x0c,0x14,0x66,0xb8,0x2c,0xa8,0x47,0x81,0x3b,0xff,0x0c,0x06,0x22,0xa0,0xc2,0x87,0x1a,0x02,0x46,0x55,0x00,0x88,0x37,0xb8,0x57,0xa8,0x27,0x20,0x88,0x11,0x89,0xc1,0xe5,0xa7,0xff,0x21,0x17,0xfe,0x88,0xc1,0x69,0x62,0x22,0xd2,0x2b,0x89,0x22,0xa0,0x46,0x83,0x2d,0x04,0x86,0x49,0x00,0x91,0x12,0xfe,0x0c,0x06,0xa2,0x09,0x00,0x22,0xa0,0xc6,0x67,0x9a,0x02,0x86,0x48,0x00,0x68,0x27,0x28,0x59,0x82,0xc8,0xf0,0x80,0x66,0xdb,0xdc,0x92,
                            0xa0,0xdb,0xdc,0x60,0x29,0x93,0x62,0xc7,0x18,0x9d,0x06,0xb2,0xa0,0xef,0xc6,0x01,0x00,0xa2,0x09,0x00,0x1b,0x99,0xa0,0xbb,0x30,0x60,0xa9,0xdb,0xdc,0x87,0x2a,0xf1,0x82,0x07,0x05,0xa2,0x07,0x04,0x62,0x07,0x06,0x80,0x88,0x11,0xa0,0x98,0x20,0x00,0x66,0x11,0x90,0x86,0x20,0x62,0x07,0x07,0x92,0xa0,0xc1,0x80,0x66,0x01,0x80,0x66,0x20,0x60,0x8b,0xdb,0xdc,0x80,0x29,0x93,0x0c,0x06,0x46,0x33,0x00,0x00,0x81,0xf9,0xfd,0x0c,0x06,0x92,0x08,0x00,0x22,0xa0,0xc6,0x67,0x99,0x02,0xc6,0x2e,0x00,0x98,0x38,0x22,0xa0,0xc8,0x67,0x19,0x02,0x06,0x2c,0x00,0x62,0x48,0x00,0x28,0x58,0x06,
                            0x2a,0x00,0x1c,0x82,0x27,0x98,0x02,0x46,0xa3,0x00,0x0c,0x06,0x0c,0x12,0x46,0x26,0x00,0x00,0x66,0x48,0x02,0x46,0xa7,0x00,0x06,0x20,0x00,0x66,0xb8,0x02,0x06,0xa9,0x00,0x46,0x01,0x00,0x66,0x48,0x02,0x06,0xa9,0x00,0x0c,0x06,0x22,0xa0,0xdb,0xdc,0x06,0x1e,0x00,0x66,0xb8,0x02,0x46,0xa7,0x00,0x06,0x18,0x00,0xc1,0xff,0xfe,0x0c,0x06,0xa8,0x0c,0x0c,0x12,0x82,0xc8,0xf0,0x9d,0x06,0x80,0x92,0x93,0xa0,0x26,0x93,0x20,0x99,0x10,0x22,0xa0,0xc6,0x67,0x99,0x52,0xb1,0xf9,0xfe,0x6d,0x09,0xd8,0x0b,0x22,0xa0,0xc9,0x87,0x3d,0x45,0x80,0xe0,0x14,0x0c,0x06,0x22,0xa0,0xdb,0xdc,0x67,
                            0x9e,0x3a,0x62,0xc7,0x18,0x2d,0x0e,0xc6,0x02,0x00,0x2a,0x96,0x98,0x09,0x4b,0x22,0x99,0x0a,0x4b,0xaa,0x0c,0x19,0x20,0xed,0xdb,0xdc,0x87,0x32,0xed,0x16,0x19,0x24,0xa9,0x0c,0xe9,0x0b,0x86,0x8e,0x00,0x00,0x00,0x66,0x88,0x02,0x86,0x92,0x00,0x0c,0x12,0x0c,0x06,0xc6,0x01,0x00,0x00,0x00,0x62,0xa0,0x00,0x22,0xa0,0xff,0x20,0xa0,0x74,0xa5,0x96,0xff,0x60,0xa0,0x74,0x65,0x96,0xff,0x25,0xa2,0xff,0x56,0xa2,0xc7,0x62,0x07,0x01,0x0c,0xf8,0x87,0x16,0x31,0x67,0x38,0x15,0x66,0x46,0x02,0x06,0x56,0x00,0x66,0x66,0x02,0xc6,0x5b,0x00,0x26,0x36,0x02,0x46,0x17,0xff,0x06,0x1b,0x00,
                            0x00,0x1c,0x22,0x27,0x96,0x02,0x06,0x50,0x00,0x22,0xa0,0xd2,0x27,0x16,0x4b,0x1c,0x12,0x27,0x16,0x02,0xc6,0x10,0xff,0x46,0x1b,0x00,0xa1,0xd2,0xfe,0x81,0xdf,0xfe,0xe0,0x08,0x00,0x61,0xd1,0xfe,0x81,0xd1,0xfe,0xdb,0xdc,0x20,0x00,0x68,0x06,0xb8,0x37,0x80,0x86,0x10,0xdb,0xdc,0x88,0x11,0x60,0x64,0x35,0x80,0x66,0x80,0xb0,0x66,0x82,0xb8,0x27,0x20,0xa2,0x20,0xb0,0xb6,0xc2,0x81,0xd5,0xfe,0xe0,0x08,0x00,0xa2,0xa3,0xe8,0x81,0xd2,0xfe,0xe0,0x08,0x00,0x46,0x00,0xff,0x00,0x00,0xd2,0x27,0x05,0xc2,0x27,0x04,0xb2,0x27,0x03,0xa8,0x27,0x25,0x9c,0xff,0x86,0xfb,0xfe,0x00,0xb2,
                            0x07,0x03,0x22,0x07,0x02,0x80,0xbb,0x11,0x20,0xbb,0x20,0xb2,0xcb,0xf0,0xa2,0xc7,0x18,0x25,0x7d,0xff,0x46,0xf5,0xfe,0x00,0x00,0x00,0x62,0x07,0x03,0x82,0x07,0x02,0x80,0x66,0x11,0x80,0x66,0x20,0x22,0xc7,0x18,0x62,0xc6,0xf0,0x0c,0x19,0x86,0x1d,0x00,0x41,0xb4,0xfe,0x71,0xb0,0xfd,0xe8,0x04,0x69,0x71,0xe0,0x77,0xdb,0xdc,0x79,0x61,0x78,0x25,0x0c,0x39,0x77,0x36,0x02,0x92,0xa0,0x01,0x99,0xd1,0xe9,0xc1,0x65,0x63,0xff,0x98,0xd1,0x71,0xad,0xfe,0xe8,0xc1,0xa1,0xac,0xfe,0xbd,0x02,0x99,0x01,0xf2,0xc1,0x18,0xdd,0x07,0xc2,0xc1,0x1c,0x81,0xb3,0xfe,0xe0,0x08,0x00,0x9d,0x0a,
                            0xb8,0x25,0xa8,0x71,0xa0,0xbb,0xdb,0xdc,0xb9,0x25,0xa0,0x66,0xdb,0xdc,0xb8,0x04,0xaa,0x22,0xa8,0x61,0xaa,0xbb,0x0b,0xa9,0xa0,0xa9,0x20,0xb9,0x04,0xa0,0xaf,0x05,0x70,0xbb,0xdb,0xdc,0xcc,0x9a,0xc2,0xdb,0xdd,0x80,0x0c,0x1d,0xdb,0xdc,0xad,0x83,0x16,0xaa,0x00,0xad,0x07,0x99,0xd1,0x25,0x74,0xff,0x98,0xd1,0x79,0x04,0x8c,0xb6,0x78,0x33,0x8c,0x77,0x90,0x7f,0x31,0x90,0x77,0xdb,0xdc,0x96,0x97,0xf7,0xd6,0x89,0x00,0x22,0xa0,0xc7,0x29,0x53,0x06,0x3e,0x00,0x00,0x56,0x49,0x0f,0x28,0x33,0x16,0x12,0xb2,0x22,0xa0,0xc8,0x06,0x01,0x00,0x00,0x00,0x22,0xa0,0xc9,0x29,0x53,0x46,
                            0xc4,0xfe,0x00,0xa8,0x27,0x56,0xba,0xb0,0x81,0x95,0xfe,0xe0,0x08,0x00,0xa1,0x84,0xfe,0x81,0x90,0xfe,0xe0,0x08,0x00,0x81,0x92,0xfe,0xe0,0x08,0x00,0xc6,0xbc,0xfe,0x68,0x37,0x16,0xe6,0xae,0x20,0xa2,0x20,0x81,0x8d,0xfe,0xe0,0x08,0x00,0xa2,0xa3,0xe8,0x81,0x88,0xfe,0xe0,0x08,0x00,0xe0,0x06,0x00,0x86,0xb5,0xfe,0x00,0x89,0xc1,0x81,0x89,0xfe,0xe0,0x08,0x00,0x88,0xc1,0xa0,0x82,0x93,0xad,0x08,0x46,0x03,0xff,0x28,0x27,0x68,0x37,0x60,0x82,0x20,0x80,0x80,0xb4,0x16,0x08,0xc1,0xc6,0x85,0xff,0xb2,0x27,0x03,0xa2,0x27,0x02,0x25,0x7f,0xff,0x22,0xa0,0x00,0x0c,0x16,0xa0,0x26,
                            0x93,0x46,0x81,0xff,0xf8,0x77,0xe8,0x67,0xd8,0x57,0xc8,0x47,0xb8,0x37,0xa8,0x27,0x0c,0x12,0x81,0x71,0xfe,0xe0,0x08,0x00,0x6d,0x0a,0x0c,0x0a,0x60,0x2a,0x83,0x06,0x7d,0xff,0xa8,0x27,0x0c,0x0b,0x81,0x6b,0xfe,0xe0,0x08,0x00,0x0c,0x02,0x06,0x76,0xff,0x00,0x28,0x27,0x68,0x37,0xdb,0xdc,0x20,0x00,0x69,0x02,0x0c,0x06,0x2d,0x06,0x06,0x75,0xff,0x21,0x59,0xfe,0x88,0x57,0x68,0x27,0x89,0x02,0x21,0x57,0xfe,0x69,0x02,0x06,0xf6,0xff,0x91,0x55,0xfe,0x0c,0x08,0x68,0x09,0x22,0xa0,0xc8,0x60,0x28,0x83,0x6d,0x02,0x21,0x51,0xfe,0x89,0x09,0x89,0x02,0x0c,0x12,0x60,0x28,0x83,0x06,
                            0x66,0xff,0x00,0x28,0x33,0x16,0x22,0xf1,0x46,0x8a,0xfe,0x1d,0xf0,0x00,0x00,0x36,0x41,0x00,0x9d,0x02,0x82,0xa0,0xdb,0xdc,0x28,0x03,0x87,0x99,0x0e,0xcc,0x32,0x0c,0x12,0xc6,0x06,0x00,0x0c,0x02,0x29,0x03,0x7c,0xe2,0x1d,0xf0,0x26,0x12,0x05,0x26,0x22,0x12,0x06,0x0c,0x00,0x82,0xa0,0xdb,0xdd,0x80,0x29,0x23,0x87,0x99,0x29,0x0c,0x22,0x29,0x03,0x06,0x08,0x00,0x22,0xa0,0xdc,0x27,0x99,0x08,0x0c,0x12,0x29,0x03,0x2d,0x08,0x1d,0xf0,0x00,0x82,0xa0,0xdd,0x7c,0xf2,0x87,0x99,0x0b,0x0c,0x12,0x29,0x03,0x22,0xa0,0xdb,0xdd,0x1d,0xf0,0x00,0x7c,0xf2,0x1d,0xf0,0x00,0x00,0xc0};


        byte uploadStub1[31] =  {0xc0,0x00,0x05,0x10,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x18,0x00,0x00,0xa4,0xeb,0xff,0x3f,0xc0};
        byte uploadStub2[31] =  {0xc0,0x00,0x07,0x14,0x00,0xe6,0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0xdb,0xdc,0xfe,0x3f,0xc0};
        byte uploadStub3[18] =  {0xc0,0x00,0x06,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x64,0xf5,0x09,0x40,0xc0};

        byte eraseFlash[10] =   {0xc0,0x00,0xd0,0x00,0x00,0x00,0x00,0x00,0x00,0xc0};

        byte configFlash1[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1c, 0x20, 0x00, 0x60, 0xc0};
        byte configFlash2[14] = {0xc0, 0x00, 0x0a, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00, 0x24, 0x20, 0x00, 0x60, 0xc0};
        byte configFlash3[26] = {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x2c,0x20,0x00,0x60,0x17,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};
        byte configFlash4[26] = {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x1c,0x20,0x00,0x60,0x00,0x00,0x00,0x90,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};
        byte configFlash5[26] = {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x24,0x20,0x00,0x60,0x9f,0x00,0x00,0x70,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};
        byte configFlash6[26] = {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x80,0x20,0x00,0x60,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};
        byte configFlash7[26] = {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x60,0x00,0x00,0x04,0x00,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};

        byte configFlash8[14] = {0xc0,0x00,0x0a,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x60,0xc0};
        byte configFlash9[14] = {0xc0,0x00,0x0a,0x04,0x00,0x00,0x00,0x00,0x00,0x80,0x20,0x00,0x60,0xc0};
        byte configFlash10[26]= {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x1c,0x20,0x00,0x60,0x40,0x00,0x00,0x80,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};
        byte configFlash11[26]= {0xc0,0x00,0x09,0x10,0x00,0x00,0x00,0x00,0x00,0x24,0x20,0x00,0x60,0x00,0x00,0x00,0x70,0xff,0xff,0xff,0xff,0x00,0x00,0x00,0x00,0xc0};
        byte configFlash12[34]= {0xc0,0x00,0x0b,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x00,0x00,0x00,0x01,0x00,0x00,0x10,0x00,0x00,0x00,0x01,0x00,0x00,0xff,0xff,0x00,0x00,0xc0};
        /* FlashAdd and md5Hash command data shall be edited based on Packet size and file Size  */
                           // SOH   DIR   OP  ,--LENGTH--,----- CHKSUM -----,---- File Size -----,    
        byte FlashAdd[26] =  {0xc0, 0x00, 0x02, 0x10,0x00,0x00,0x00,0x00,0x00,0xE0,0xb7,0x0d,0x00,0x0e,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x01,0x00,0xc0};
                            // SOH  DIR  OP ,PKT LENGTH, ----- CHKSUM ---,                    ,---FILE Size -----,
        byte md5Hash[26] =   {0xc0,0x00,0x13,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0xE0,0xb7,0x0d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xc0};

        byte FlashLeave1[26] = {0xc0,0x00,0x02,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0xc0};
        byte FlashLeave2[14] = {0xc0,0x00,0x04,0x04,0x00,0x00,0x00,0x00,0x00,0x01,0x00,0x00,0x00,0xc0};
        const unsigned char subst_C0[2] = { 0xDB, 0xDC };
        const unsigned char subst_DB[2] = { 0xDB, 0xDD };
                    // {Start of PAcket, Direction, Opcode, Length of packet }
       // unsigned char Startheader[5] = {0xc0,0x00,0x03,0x10,0x04};  // 1024 Packet size 
        unsigned char Startheader[5] = {0xc0,0x00,0x03,0x10,0x10};  // 4096 Packet size
       /* Following header shall be edited based on Packet size */
        //unsigned char Startheader[5] = {0xc0,0x00,0x03,0x10,0x40};   // 16384+16 Packet size
        //unsigned char header2[4] = {0x00,0x40,0x00,0x00};  // Packet size 16384 (0x4000)
        unsigned char header2[4] = {0x00,0x10,0x00,0x00};  // Packet size 16384 (0x4000)
        unsigned char paddingZero[8] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        unsigned char readBuf[FLASH_BLOCK_SIZE];
        unsigned char PktBuf[FLASH_BLOCK_SIZE+2048];        
};

#endif